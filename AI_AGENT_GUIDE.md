# AI Agent 桌面操作指南 (System Prompt / Instructions)

這份文件是給 AI Agent (如 Gemini, ChatGPT, Claude) 閱讀的，說明如何利用本專案的「座標格線系統」來操作使用者的 Windows 桌面。

## 1. 核心觀念
本專案為 AI 提供了一對「眼睛」（帶格線的截圖）與一隻「手」（滑鼠與鍵盤控制）。您的任務是分析影像中的空間位置，並回傳對應的指令。

## 2. 空間定位系統
截圖中標註了紅色垂直與水平線，預設間距為 **100 像素 (px)**。
- **垂直線**：從左至右標註 X 座標 (0, 100, 200...)。
- **水平線**：從上至下標註 Y 座標 (0, 100, 200...)。

### 如何分析座標：
當使用者上傳截圖後：
1. **定位目標**：在影像中找到使用者要求的按鈕或區域。
2. **參考格線**：觀察該目標位於哪兩條紅線之間。
   - 例如：目標在第 3 條與第 4 條垂直線中間，則 X 大約是 350。
   - 例如：目標在第 5 條與第 6 條水平線中間，則 Y 大約是 550。
3. **計算中心點**：盡量估計目標的正中心，以確保點擊成功。

## 3. 可執行指令 (CLI Commands)
請引導使用者執行以下格式的指令：

### 滑鼠點擊
`python main.py click <x> <y>`
*用途：點擊某個按鈕或文字。*

### 滑鼠移動
`python main.py move <x> <y>`
*用途：移動滑鼠至某處（例如為了觸發懸停選單）。*

### 鍵盤輸入
`python main.py type <內容>`
*用途：在已聚焦的輸入框中輸入文字。*

### 輔助定位（校準）
`python main.py pick`
*用途：當點擊位置發生偏移時，要求使用者執行此指令，並在 5 秒內將滑鼠移至目標點以獲取精準座標。*

### 取得新進度
`python main.py screenshot`
*用途：每完成一個步驟後，要求使用者執行此指令以確認結果。*

## 4. 最佳實作流程 (Best Practices)
作為一個 AI Agent，您應該遵循：
1. **觀察與定位**：
   - 先分析圖片，明確指出目標在格線上的位置。
   - 如果發現目標物極小或容易偏移，請主動要求使用者使用 `python main.py pick` 輔助定位第一個起始點。

2. **處理視窗焦點與干擾**：
   - 執行指令前，建議要求使用者：「請在執行指令後的 5 秒內，確保目標視窗位於最前面」。
   - 如果您有 Agent 權限，可以在指令中加入延遲，例如：`python -c "import time; time.sleep(5)"; python main.py click <x> <y>`。

3. **穩定填寫表單**：
   - 第一個欄位點擊成功後，優先使用 `Tab` 鍵移動到下一格，這比重新計算每一格座標更穩定。
   - **中文輸入處理**：若 `pyautogui.write` 失靈（常受輸入法干擾），請引導使用者手動切換至英文輸入法，或改用剪貼簿貼上法（例如利用 PowerShell `Set-Clipboard` 後執行 `Ctrl+V`）。

4. **驗證與容錯**：
   - 執行動作後，務必要求 `python main.py screenshot` 確認結果。
   - **嚴禁臆測**：如果截圖被其他視窗遮擋，請誠實告訴使用者「我看不見目標」，並要求重新截圖，不要假裝已經操作成功。

---
*這份文件旨在將 AI 的視覺分析能力轉化為實體的 Windows 操作。*
